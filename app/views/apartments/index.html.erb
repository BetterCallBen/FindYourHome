<div class="container"
     data-controller="apartments"
     data-apartments-locations-value="<%= @locations_ids.nil? ? [] : @locations_ids.split(",") %>">

  <%= form_with(url: apartments_path, method: :get, data: { 'apartments-target': 'form'}) do |f| %>

    <div class="status-filter div-filter">

      <h3>Status</h3>
      <input class="filter" data-action="input->apartments#submitForm" type="radio" id="furnished" name="status" value="furnished" <%= 'checked' if params[:status] == "furnished"%>>
      <label class="tag" for="furnished">Meublé</label>

      <input class="filter" data-action="input->apartments#submitForm" type="radio" id="unfurnished" name="status" value="unfurnished" <%= 'checked' if params[:status] == "unfurnished"%>>
      <label class="tag" for="unfurnished">Non meublé</label>

    </div>

    <div class="rooms-filter div-filter">

      <label class="tag">Nombre de pièce</label>
      <input placeholder="Min" class="filter" data-action="keyup->apartments#changeRooms" min="1" max="120" type="number" name="rooms_min" value=<%= params[:rooms_min] if params[:rooms_min].present? %> >
      <input placeholder="Max" class="filter" data-apartments-target="secondRoomsInput" data-action="keyup->apartments#validRooms" min="1" max="120" type="number" name="rooms_max" value=<%= params[:rooms_max] if params[:rooms_max].present? && params[:rooms_max].to_i >= params[:rooms_min].to_i %> >

    </div>
    <div class="surface-filter div-filter">
      <label class="tag">Surface</label>

      <input placeholder="Min" class="filter" data-action="keyup->apartments#changeSurface"  min="1" max="120" type="number" name="surface_min" value=<%= params[:surface_min] if params[:surface_min].present? %> >
      <input placeholder="Max" class="filter" data-apartments-target="secondSurfaceInput" data-action="keyup->apartments#validSurface" min="1" max="120" type="number" name="surface_max" value=<%= params[:surface_max] if params[:surface_max].present? && params[:surface_max].to_i >= params[:surface_min].to_i %> >


    </div>

    <div class="cities-filter div-filter">
      <h3>Critères</h3>
      <input class="filter" data-action="input->apartments#submitForm" type="checkbox" id="balcony" name="balcony" value="true" <%= 'checked' if params[:balcony] == "true"%>>
      <label class="tag" for="balcony">Balcon</label>

      <input class="filter" data-action="input->apartments#submitForm" type="checkbox" id="chimney" name="chimney" value="true" <%= 'checked' if params[:chimney] == "true"%>>
      <label class="tag" for="chimney">Cheminée</label>

      <input class="filter" data-action="input->apartments#submitForm" type="checkbox" id="elevator" name="elevator" value="true" <%= 'checked' if params[:elevator] == "true"%>>
      <label class="tag" for="elevator">Ascenseur</label>

    </div>

    <input placeholder="Saisissez une ville ou un arrondissement" class="search-input" type="text" data-action="keyup->apartments#searchLocations">

    <input class="filter d-none" data-apartments-target="locations" name="locations" value="<%= params[:locations] if params[:locations] %>">
    <div class="locations-results" data-apartments-target="locationResults"></div>

    <% unless @locations_tags.nil? %>
      <div class="location-tags">
        <% @locations_tags.each do |location_tag| %>
          <p data-id="<%= location_tag.id %>" class="location-tag" data-action="click->apartments#removeLocation"><%= location_tag.name %> <i class="fa-solid fa-xmark cross"></i></p>
        <% end %>
      </div>
    <% end %>


  <% end %>

  <h1>Apartments</h1>
  <div class="apartment-cards" data-apartments-target="apartments">
    <%= render 'apartments', apartments: @apartments %>
  </div>
</div>

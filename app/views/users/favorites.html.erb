<div class="favorite-container">
  <div class="favorite-cards">
    <div class="actions">
      <%= link_to :back, class: "action-back" do %>
        <i class="fa-solid fa-arrow-left back-icon"></i>
      <% end %>

      <h3 class="title">Mes favoris</h3>

    </div>
    <% @favorites.each do |property| %>
      <div class="favorite-link-action">

        <%= link_to property.instance_of?(Apartment) ? apartment_path(property) : house_path(property), class:"favorite-card" do %>

          <div class="favorite-image">
            <%= image_tag property.image_url, class:"image" %>
          </div>

          <div class="favorite-content">

            <div class="main-content">
              <p class="favorite-location">
                <%= property.borough.name if property.borough %>
                <%= property.city.name %>
              </p>

              <h4 class="favorite-title">
                <%= translate_type(property.class.name) %>
                <%= "#{translate_status(property.status)} de" if property.status %>
                <%= property.surface %> m2
                <%= humanize_project(property.project) %>
              </h4>

              <div class="line"></div>

              <p class="favorite-infos">
                <%= pluralize(property.rooms, "pièce") %>
                <%= pluralize(property.bedrooms, "chambre") %>
            </div>

            <div class="infos">
              <h3 class="price bold"><%= property.price %> €</h3>
            </div>

          </div>

        <% end %>

        <% if @favorites.present? && @favorites.include?(property) %>

          <div data-action="click->favorite#removeFavorite"
              data-property-id="<%= property.id %>"
              data-type="<%= property.class.name.downcase %>s">
            <div class="favorite-heart">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="heart-icon active">
                <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
              </svg>

            </div>
          </div>

        <% else %>

          <div data-action="click->favorite#addFavorite"
              data-property-id="<%= property.id %>"
              data-type="<%= property.class.name.downcase %>s">
            <div class="favorite-heart">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="heart-icon">
                <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
              </svg>

            </div>
          </div>

        <% end %>
      </div>

    <% end %>
  </div>
  <div style="width: 100%; height: 600px;"
       data-controller="map"
       data-map-markers-value="<%= @markers.to_json %>"
       data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
